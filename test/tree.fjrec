type bool
data constructor True : {} -> bool
data constructor False : {} -> bool

type int
data constructor Zero : {} -> int
data constructor Succ : { int } -> int

type tree
data constructor Leaf : {} -> tree
data constructor Node : { tree ; int ; tree } -> tree

program
  let rec eq (a : int) (b : int) : bool =
    match a return bool with
    | Zero {} ->
        match b return bool with
        | Zero {} -> True {}
        | Succ { m } -> False {}
        end
    | Succ { n } ->
        match b return bool with
        | Zero {} -> False {}
        | Succ { m } -> eq n m
        end
    end
  in

  let rec search (t : tree) (n : int) : bool =
    match t return bool with
    | Leaf {} -> False {}
    | Node { left ; m ; right } ->
        match eq m n return bool with
        | True {} -> True {}
        | False {} ->
            match search left n return bool with
            | True {} -> True {}
            | False {} -> search right n
            end
        end
    end
  in

  let n = Succ { Zero {} } in
  let m = Succ { n } in
  let mytree = Node { Leaf {} ; n ; Node { Leaf {} ; m ; Leaf {} } } in
  search mytree m
